<% provide(:title, "Calendar") %>
<%= javascript_include_tag 'https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js' %>
<%= javascript_include_tag "jquery.qtip-1.0.0-rc3.min.js" %>

<script type="text/javascript">
// alert ("snapping");
    var snapper = new Snap({
		element: document.getElementById('content'),
		dragger: null,
		disable: 'none',
		addBodyClasses: true,
		hyperextensible: false,
		resistance: 0.5,
		flickThreshold: 50,
		transitionSpeed: 0.3,
		easing: 'ease',
		maxPosition: 266,
		minPosition: -266,
		tapToClose: true,
		touchToDrag: true,
		slideIntent: 40,
		minDragDistance: 5
	});
	// toggleSnap();

	<% current_user.hidden_category_flags.each do |hcf| %>
		toggleCalendarFilterCategory(<%= hcf.category_id %>);
	<% end %>
</script>

<div id='loading' class="loading">Loading calendar...</div>
<div id='calendar' class="calendar"></div>

<hr />

<style type="text/css">
label {
    display: block;
    padding-left: 15px;
    text-indent: -15px;
}
input {
    height: 13px;
    padding: 0;
    margin:0;
    vertical-align: bottom;
    position: relative;
    top: -1px;
    *overflow: hidden;
}
.no-underline-on-hover a:hover {
	text-decoration: none;
}
</style>

<% content_for :snap_menu do %>

<%= form_tag '#', class: "form-horizontal" do %>
	<div class="panel-group" id="accordion">
	  <div xclass="panel panel-default">
	    <div id="collapseOne" xclass="panel-collapse">
			<div xclass="panel-heading">
				<div class="panel-body">
					<h4 class="panel-title">Checked Items Are Visible</h4>
					<div class="panel-body">
						
  					  <% @calendars.each do |calendar| %>
						<div class="control-group form-group" style="margin:0; margin-left:-15px;">
							<%= check_box_tag "calendar-#{calendar.id}", calendar.id, true, :onclick => "toggleCalendar_#{calendar.id}();", :style => "width:13px" %>
							<%= calendar.description %>
							<script type="text/javascript" charset="utf-8">
							function toggleCalendar_<%= calendar.id %>() {
								var on_or_off = $("#calendar-<%= calendar.id %>").is(":checked");
								// alert("checked is " + on_or_off);
								<% calendar.categories.each do |category| %>
									$("#category-<%= category.id %>").prop('checked', on_or_off);
									toggleCalendarFilterCategory(<%= category.id %>);
								<% end %>
							}
							</script>
						</div>
						<% calendar.categories.each do |category| %>
							<div class="control-group form-group" style="margin:0; margin-left:5px;">
								<div class="controls">

									<label class="checkbox inline" style="font-weight:normal;">
										<%= check_box_tag "category-#{category.id}", category.id, current_user.wants_to_see_category(category), :onclick => "toggleCalendarFilterCategory(#{category.id});", :style => "width:13px" %>
										&nbsp; &nbsp;
										<%= color_scheme_as_html_snippet_to_display(category.color_scheme) %>
										<%= category.description %> 
										<!-- <span class="badge pull-right"><%= category.events.count %></span> -->
									</label>
								</div>
							</div>
						<% end %>

  					  <% end %>
					</div>
				</div>
		    </div>
	    </div>
	  </div>
	</div>
<% end %>
<% end %>

<% if Rails.env.development? %>
   <ul>
      <li> <%= link_to "QTIP", "http://craigsworks.com/projects/qtip/" %> 
      <li>Nice example of tool tip on calendar: <%= link_to "http://obpk.com/fc/ex/fc.html", "http://obpk.com/fc/ex/fc.html" %></li>
   </ul>
<% end %>

<% if 1 == 0 %>


   <%= calendar_for(@styles) do |t| %>
     <%= t.head('mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun') %>
     <% t.day(:day_method => :created_at) do |day, styles| %>
       <%= day.day %><br/>
       <% styles.each do |style| %>
         <%= style.name %>
         <small><%= style.created_at %></small>
         <br/>
       <% end %>
     <% end %>
  <% end %>
<% end %>

